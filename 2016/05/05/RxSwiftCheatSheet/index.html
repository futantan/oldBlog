<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />



  <meta name="google-site-verification" content="fM7xhodGN-lmnxxoctwYISpLNlWpPA7lgcadx01MSa8" />














  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="RxSwift," />





  <link rel="alternate" href="/atom.xml" title="Prayer's blog" type="application/atom+xml" />






<meta name="description" content="本文档内容来自于 RxSwift 的 Playground。记录大多数 ReactiveX 的概念和操作符。  GitHub 地址">
<meta name="keywords" content="RxSwift">
<meta property="og:type" content="article">
<meta property="og:title" content="RxSwift 速查手册">
<meta property="og:url" content="http://www.futantan.com/2016/05/05/RxSwiftCheatSheet/index.html">
<meta property="og:site_name" content="Prayer&#39;s blog">
<meta property="og:description" content="本文档内容来自于 RxSwift 的 Playground。记录大多数 ReactiveX 的概念和操作符。  GitHub 地址">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/defer.png">
<meta property="og:image" content="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/publishsubject.png">
<meta property="og:image" content="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/publishsubject_error.png">
<meta property="og:image" content="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/replaysubject.png">
<meta property="og:image" content="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/behaviorsubject.png">
<meta property="og:image" content="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/behaviorsubject_error.png">
<meta property="og:image" content="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/map.png">
<meta property="og:image" content="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/flatmap.png">
<meta property="og:image" content="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/scan.png">
<meta property="og:image" content="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/filter.png">
<meta property="og:image" content="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/distinct.png">
<meta property="og:image" content="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/take.png">
<meta property="og:image" content="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/startwith.png">
<meta property="og:image" content="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/combinelatest.png">
<meta property="og:image" content="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/zip.png">
<meta property="og:image" content="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/merge.png">
<meta property="og:image" content="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/switch.png">
<meta property="og:image" content="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/catch.png">
<meta property="og:image" content="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/retry.png">
<meta property="og:image" content="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/do.png">
<meta property="og:image" content="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/takeuntil.png">
<meta property="og:image" content="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/takewhile.png">
<meta property="og:image" content="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/concat.png">
<meta property="og:image" content="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/reduce.png">
<meta property="og:updated_time" content="2017-10-27T09:49:38.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="RxSwift 速查手册">
<meta name="twitter:description" content="本文档内容来自于 RxSwift 的 Playground。记录大多数 ReactiveX 的概念和操作符。  GitHub 地址">
<meta name="twitter:image" content="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/defer.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}
  };
</script>



  <link rel="canonical" href="http://www.futantan.com/2016/05/05/RxSwiftCheatSheet/"/>





  <title>RxSwift 速查手册 | Prayer's blog</title>
  




<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-56681721-1', 'auto');
  ga('send', 'pageview');
</script>





</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Prayer's blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">爱这个世界</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.futantan.com/2016/05/05/RxSwiftCheatSheet/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Prayer">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://avatars2.githubusercontent.com/u/6268441">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Prayer's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">RxSwift 速查手册</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-05-05T20:04:36+08:00">
                2016-05-05
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2016/05/05/RxSwiftCheatSheet/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2016/05/05/RxSwiftCheatSheet/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <blockquote>
<p>本文档内容来自于 <a href="https://github.com/ReactiveX/RxSwift" target="_blank" rel="noopener">RxSwift</a> 的 Playground。记录大多数 ReactiveX 的概念和操作符。</p>
</blockquote>
<p><a href="https://github.com/futantan/RxSwiftCheatSheet" target="_blank" rel="noopener">GitHub 地址</a> </p>
<a id="more"></a>
<p>(部分翻译和注解来自 <a href="https://mcxiaoke.gitbooks.io/rxdocs/content/Subject.html" target="_blank" rel="noopener">ReactiveX文档中文翻译</a>)</p>
<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><h2 id="为什么使用-RxSwift"><a href="#为什么使用-RxSwift" class="headerlink" title="为什么使用 RxSwift?"></a>为什么使用 RxSwift?</h2><p>我们写的很多代码实际上是为了解决和响应外部事件。当用户操作一个控件的时候，我们需要使用 @IBAction 来响应事件。我们需要观察通知来检测键盘改变位置。当 URL Sessions 带着响应的数据返回时，我们需要提供闭包来执行我们的操作。我们还需要使用 KVO 来检测变量的值改变。这些大量的编写机制使得我们的代码结构变的更加复杂。如果有一种统一的编写机制来完成所有的这些调用/响应代码是不是更棒呢？Rx 就是为解决这些问题而生的。</p>
<h2 id="Observable"><a href="#Observable" class="headerlink" title="Observable"></a>Observable</h2><p>理解 RxSwift 的关键是理解 Observable 的概念。要理解它的创建，操作以及为了对变化做出响应操作而进行的订阅（subscribe）。</p>
<h2 id="创建和订阅-Observable"><a href="#创建和订阅-Observable" class="headerlink" title="创建和订阅 Observable"></a>创建和订阅 Observable</h2><p>要理解本框架，第一步需要理解如何创建 Observable。有很多函数可以创建 Observable。</p>
<p>创建 Observable 之后，如果没有订阅者订阅该 observable，那么什么事情也不会发生，所以我们将同时解释创建和订阅。</p>
<h3 id="empty"><a href="#empty" class="headerlink" title="empty"></a>empty</h3><p><code>empty</code> 创建一个空的序列。它仅发送 <code>.Completed</code> 消息。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">example(<span class="string">"empty"</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> emptySequence = <span class="type">Observable</span>&lt;<span class="type">Int</span>&gt;.empty()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> subscription = emptySequence</span><br><span class="line">        .subscribe &#123; event <span class="keyword">in</span></span><br><span class="line">            <span class="built_in">print</span>(event)</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">--- empty example ---</span><br><span class="line">Completed</span><br></pre></td></tr></table></figure>
<h3 id="never"><a href="#never" class="headerlink" title="never"></a>never</h3><p><code>never</code> 创建一个序列，该序列永远不会发送消息，<code>.Completed</code> 消息也不会发送。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">example(<span class="string">"never"</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> neverSequence = <span class="type">Observable</span>&lt;<span class="type">Int</span>&gt;.never()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> subscription = neverSequence</span><br><span class="line">        .subscribe &#123; <span class="number">_</span> <span class="keyword">in</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"This block is never called."</span>)</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">--- never example ---</span><br></pre></td></tr></table></figure></p>
<h3 id="just"><a href="#just" class="headerlink" title="just"></a>just</h3><p><code>just</code> 代表只包含一个元素的序列。它将向订阅者发送两个消息，第一个消息是其中元素的值，另一个是 <code>.Completed</code>。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">example(<span class="string">"just"</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> singleElementSequence = <span class="type">Observable</span>.just(<span class="number">32</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> subscription = singleElementSequence</span><br><span class="line">        .subscribe &#123; event <span class="keyword">in</span></span><br><span class="line">            <span class="built_in">print</span>(event)</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">--- just example ---</span><br><span class="line">Next(32)</span><br><span class="line">Completed</span><br></pre></td></tr></table></figure>
<h3 id="sequenceOf"><a href="#sequenceOf" class="headerlink" title="sequenceOf"></a>sequenceOf</h3><p><code>sequenceOf</code> 通过固定数目的元素创建一个序列</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">example(<span class="string">"sequenceOf"</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> sequenceOfElements<span class="comment">/* : Observable&lt;Int&gt; */</span> = <span class="type">Observable</span>.of(<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> subscription = sequenceOfElements</span><br><span class="line">        .subscribe &#123; event <span class="keyword">in</span></span><br><span class="line">            <span class="built_in">print</span>(event)</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">--- sequenceOf example ---</span><br><span class="line">Next(0)</span><br><span class="line">Next(1)</span><br><span class="line">Next(2)</span><br><span class="line">Next(3)</span><br><span class="line">Next(4)</span><br><span class="line">Next(5)</span><br><span class="line">Next(6)</span><br><span class="line">Next(7)</span><br><span class="line">Next(8)</span><br><span class="line">Next(9)</span><br><span class="line">Completed</span><br></pre></td></tr></table></figure>
<h3 id="toObservable"><a href="#toObservable" class="headerlink" title="toObservable"></a>toObservable</h3><p><code>toObservable</code> 在一个数组的基础上创建一个序列</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">example(<span class="string">"toObservable"</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> sequenceFromArray = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>].toObservable()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> subscription = sequenceFromArray</span><br><span class="line">        .subscribe &#123; event <span class="keyword">in</span></span><br><span class="line">            <span class="built_in">print</span>(event)</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">--- toObservable example ---</span><br><span class="line">Next(1)</span><br><span class="line">Next(2)</span><br><span class="line">Next(3)</span><br><span class="line">Next(4)</span><br><span class="line">Next(5)</span><br><span class="line">Completed</span><br></pre></td></tr></table></figure>
<h3 id="create"><a href="#create" class="headerlink" title="create"></a>create</h3><p><code>create</code> 使用 Swift 闭包来创建一个序列。该例子中，创建了 <code>just</code> 操作符的自定义版本。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">example(<span class="string">"create"</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> myJust = &#123; (singleElement: <span class="type">Int</span>) -&gt; <span class="type">Observable</span>&lt;<span class="type">Int</span>&gt; <span class="keyword">in</span></span><br><span class="line">        <span class="keyword">return</span> <span class="type">Observable</span>.create &#123; observer <span class="keyword">in</span></span><br><span class="line">            observer.on(.<span class="type">Next</span>(singleElement))</span><br><span class="line">            observer.on(.<span class="type">Completed</span>)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> <span class="type">NopDisposable</span>.instance</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> subscription = myJust(<span class="number">5</span>)</span><br><span class="line">        .subscribe &#123; event <span class="keyword">in</span></span><br><span class="line">            <span class="built_in">print</span>(event)</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">--- create example ---</span><br><span class="line">Next(5)</span><br><span class="line">Completed</span><br></pre></td></tr></table></figure>
<h3 id="generate"><a href="#generate" class="headerlink" title="generate"></a>generate</h3><p><code>generate</code> 创建的序列可以自己生成它的值，并且在之前值的基础上来判断什么时候结束。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">example(<span class="string">"generate"</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> generated = <span class="type">Observable</span>.generate(</span><br><span class="line">        initialState: <span class="number">0</span>,</span><br><span class="line">        condition: &#123; $<span class="number">0</span> &lt; <span class="number">3</span> &#125;,</span><br><span class="line">        iterate: &#123; $<span class="number">0</span> + <span class="number">1</span> &#125;</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> subscription = generated</span><br><span class="line">        .subscribe &#123; event <span class="keyword">in</span></span><br><span class="line">            <span class="built_in">print</span>(event)</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">--- generate example ---</span><br><span class="line">Next(0)</span><br><span class="line">Next(1)</span><br><span class="line">Next(2)</span><br><span class="line">Completed</span><br></pre></td></tr></table></figure>
<h3 id="error"><a href="#error" class="headerlink" title="error"></a>error</h3><p>创建一个不发送任何 item 的 Observable，以 error 中指</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">example(<span class="string">"error"</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> error = <span class="type">NSError</span>(domain: <span class="string">"Test"</span>, code: -<span class="number">1</span>, userInfo: <span class="literal">nil</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> erroredSequence = <span class="type">Observable</span>&lt;<span class="type">Int</span>&gt;.error(error)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> subscription = erroredSequence</span><br><span class="line">        .subscribe &#123; event <span class="keyword">in</span></span><br><span class="line">            <span class="built_in">print</span>(event)</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">--- error example ---</span><br><span class="line">Error(Error Domain=Test Code=-1 &quot;(null)&quot;)</span><br></pre></td></tr></table></figure>
<h3 id="deferred"><a href="#deferred" class="headerlink" title="deferred"></a>deferred</h3><p>直到 observer 订阅之后才创建 Observable，并且为每一个 observer 创建一个全新的 Observable<br>do not create the Observable until the observer subscribes, and create a fresh Observable for each observer</p>
<p><img src="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/defer.png" alt=""></p>
<p><a href="http://reactivex.io/documentation/operators/defer.html" target="_blank" rel="noopener">更多相关内容请查看 reactive.io</a></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">example(<span class="string">"deferred"</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> deferredSequence: <span class="type">Observable</span>&lt;<span class="type">Int</span>&gt; = <span class="type">Observable</span>.deferred &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"creating"</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="type">Observable</span>.create &#123; observer <span class="keyword">in</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"emmiting"</span>)</span><br><span class="line">            observer.on(.<span class="type">Next</span>(<span class="number">0</span>))</span><br><span class="line">            observer.on(.<span class="type">Next</span>(<span class="number">1</span>))</span><br><span class="line">            observer.on(.<span class="type">Next</span>(<span class="number">2</span>))</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> <span class="type">NopDisposable</span>.instance</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="number">_</span> = deferredSequence</span><br><span class="line">        .subscribe &#123; event <span class="keyword">in</span></span><br><span class="line">            <span class="built_in">print</span>(event)</span><br><span class="line">         &#125;</span><br><span class="line"></span><br><span class="line">    <span class="number">_</span> = deferredSequence</span><br><span class="line">        .subscribe &#123; event <span class="keyword">in</span></span><br><span class="line">            <span class="built_in">print</span>(event)</span><br><span class="line">         &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">--- deferred example ---</span><br><span class="line">creating</span><br><span class="line">emmiting</span><br><span class="line">Next(0)</span><br><span class="line">Next(1)</span><br><span class="line">Next(2)</span><br><span class="line">creating</span><br><span class="line">emmiting</span><br><span class="line">Next(0)</span><br><span class="line">Next(1)</span><br><span class="line">Next(2)</span><br></pre></td></tr></table></figure>
<p>在 RxCocoa 库中还有很多其他非常有用的方法，例如：</p>
<ul>
<li><code>rx_observe</code> 存在于所有 NSObject 子类中，封装了 KVO</li>
<li><code>rx_tap</code> 存在于 button 中，封装了 @IBActions</li>
<li><code>rx_notification</code> 封装了 NotificationCenter</li>
<li>…</li>
</ul>
<h1 id="Subjects"><a href="#Subjects" class="headerlink" title="Subjects"></a>Subjects</h1><p>Subject 可以看成是一个桥梁或者代理，在某些ReactiveX实现中，它同时充当了 Observer 和 Observable 的角色。因为它是一个Observer，它可以订阅一个或多个 Observable；又因为它是一个 Observable，它可以转发它收到(Observe)的数据，也可以发射新的数据。</p>
<p>辅助函数：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">writeSequenceToConsole</span>&lt;O: ObservableType&gt;<span class="params">(name: String, sequence: O)</span></span> -&gt; <span class="type">Disposable</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> sequence</span><br><span class="line">        .subscribe &#123; e <span class="keyword">in</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"Subscription: \(name), event: \(e)"</span>)</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="PublishSubject"><a href="#PublishSubject" class="headerlink" title="PublishSubject"></a>PublishSubject</h2><p><code>PublishSubject</code> 只会把在订阅发生的时间点之后来自原始Observable的数据发射给观察者。</p>
<p><img src="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/publishsubject.png" alt=""></p>
<p><img src="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/publishsubject_error.png" alt=""></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">example(<span class="string">"PublishSubject"</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> disposeBag = <span class="type">DisposeBag</span>()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> subject = <span class="type">PublishSubject</span>&lt;<span class="type">String</span>&gt;()</span><br><span class="line">    writeSequenceToConsole(<span class="string">"1"</span>, sequence: subject).addDisposableTo(disposeBag)</span><br><span class="line">    subject.on(.<span class="type">Next</span>(<span class="string">"a"</span>))</span><br><span class="line">    subject.on(.<span class="type">Next</span>(<span class="string">"b"</span>))</span><br><span class="line">    writeSequenceToConsole(<span class="string">"2"</span>, sequence: subject).addDisposableTo(disposeBag)</span><br><span class="line">    subject.on(.<span class="type">Next</span>(<span class="string">"c"</span>))</span><br><span class="line">    subject.on(.<span class="type">Next</span>(<span class="string">"d"</span>))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">--- PublishSubject example ---</span><br><span class="line">Subscription: 1, event: Next(a)</span><br><span class="line">Subscription: 1, event: Next(b)</span><br><span class="line">Subscription: 1, event: Next(c)</span><br><span class="line">Subscription: 2, event: Next(c)</span><br><span class="line">Subscription: 1, event: Next(d)</span><br><span class="line">Subscription: 2, event: Next(d)</span><br></pre></td></tr></table></figure>
<h2 id="ReplaySubject"><a href="#ReplaySubject" class="headerlink" title="ReplaySubject"></a>ReplaySubject</h2><p><code>ReplaySubject</code> 会发射所有来自原始Observable的数据给观察者，无论它们是何时订阅的。当一个新的 observer 订阅了一个 <code>ReplaySubject</code> 之后，他将会收到当前缓存在 buffer 中的数据和这之后产生的新数据。在下面的例子中，缓存大小为 <code>1</code> 所以 observer 将最多能够收到订阅时间点之前的一个数据。例如，<code>Subscription: 2</code> 能够收到消息 <code>&quot;b&quot;</code>，而这个消息是在他订阅之前发送的，但是没有办法收到消息 <code>&quot;a&quot;</code> 因为缓存的容量小于 <code>2</code>。</p>
<p><img src="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/replaysubject.png" alt=""></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">example(<span class="string">"ReplaySubject"</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> disposeBag = <span class="type">DisposeBag</span>()</span><br><span class="line">    <span class="keyword">let</span> subject = <span class="type">ReplaySubject</span>&lt;<span class="type">String</span>&gt;.create(bufferSize: <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    writeSequenceToConsole(<span class="string">"1"</span>, sequence: subject).addDisposableTo(disposeBag)</span><br><span class="line">    subject.on(.<span class="type">Next</span>(<span class="string">"a"</span>))</span><br><span class="line">    subject.on(.<span class="type">Next</span>(<span class="string">"b"</span>))</span><br><span class="line">    writeSequenceToConsole(<span class="string">"2"</span>, sequence: subject).addDisposableTo(disposeBag)</span><br><span class="line">    subject.on(.<span class="type">Next</span>(<span class="string">"c"</span>))</span><br><span class="line">    subject.on(.<span class="type">Next</span>(<span class="string">"d"</span>))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">--- ReplaySubject example ---  </span><br><span class="line">Subscription: 1, event: Next(a)  </span><br><span class="line">Subscription: 1, event: Next(b)  </span><br><span class="line">Subscription: 2, event: Next(b)  </span><br><span class="line">Subscription: 1, event: Next(c)  </span><br><span class="line">Subscription: 2, event: Next(c)  </span><br><span class="line">Subscription: 1, event: Next(d)  </span><br><span class="line">Subscription: 2, event: Next(d)</span><br></pre></td></tr></table></figure>
<h2 id="BehaviorSubject"><a href="#BehaviorSubject" class="headerlink" title="BehaviorSubject"></a>BehaviorSubject</h2><p>当观察者订阅 <code>BehaviorSubject</code> 时，它开始发射原始 Observable 最近发射的数据（如果此时还没有收到任何数据，它会发射一个默认值），然后继续发射其它任何来自原始Observable的数据。 </p>
<p><img src="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/behaviorsubject.png" alt=""></p>
<p><img src="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/behaviorsubject_error.png" alt=""></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">example(<span class="string">"BehaviorSubject"</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> disposeBag = <span class="type">DisposeBag</span>()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> subject = <span class="type">BehaviorSubject</span>(value: <span class="string">"z"</span>)</span><br><span class="line">    writeSequenceToConsole(<span class="string">"1"</span>, sequence: subject).addDisposableTo(disposeBag)</span><br><span class="line">    subject.on(.<span class="type">Next</span>(<span class="string">"a"</span>))</span><br><span class="line">    subject.on(.<span class="type">Next</span>(<span class="string">"b"</span>))</span><br><span class="line">    writeSequenceToConsole(<span class="string">"2"</span>, sequence: subject).addDisposableTo(disposeBag)</span><br><span class="line">    subject.on(.<span class="type">Next</span>(<span class="string">"c"</span>))</span><br><span class="line">    subject.on(.<span class="type">Next</span>(<span class="string">"d"</span>))</span><br><span class="line">    subject.on(.<span class="type">Completed</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">--- BehaviorSubject example ---</span><br><span class="line">Subscription: 1, event: Next(z)</span><br><span class="line">Subscription: 1, event: Next(a)</span><br><span class="line">Subscription: 1, event: Next(b)</span><br><span class="line">Subscription: 2, event: Next(b)</span><br><span class="line">Subscription: 1, event: Next(c)</span><br><span class="line">Subscription: 2, event: Next(c)</span><br><span class="line">Subscription: 1, event: Next(d)</span><br><span class="line">Subscription: 2, event: Next(d)</span><br><span class="line">Subscription: 1, event: Completed</span><br><span class="line">Subscription: 2, event: Completed</span><br></pre></td></tr></table></figure>
<h2 id="Variable"><a href="#Variable" class="headerlink" title="Variable"></a>Variable</h2><p><code>Variable</code> 封装了 <code>BehaviorSubject</code>。使用 variable 的好处是 variable 将不会显式的发送 <code>Error</code> 或者 <code>Completed</code>。在 deallocated 的时候，<code>Variable</code> 会自动的发送 complete 事件。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">example(<span class="string">"Variable"</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> disposeBag = <span class="type">DisposeBag</span>()</span><br><span class="line">    <span class="keyword">let</span> variable = <span class="type">Variable</span>(<span class="string">"z"</span>)</span><br><span class="line">    writeSequenceToConsole(<span class="string">"1"</span>, sequence: variable.asObservable()).addDisposableTo(disposeBag)</span><br><span class="line">    variable.value = <span class="string">"a"</span></span><br><span class="line">    variable.value = <span class="string">"b"</span></span><br><span class="line">    writeSequenceToConsole(<span class="string">"2"</span>, sequence: variable.asObservable()).addDisposableTo(disposeBag)</span><br><span class="line">    variable.value = <span class="string">"c"</span></span><br><span class="line">    variable.value = <span class="string">"d"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">--- Variable example ---</span><br><span class="line">Subscription: 1, event: Next(z)</span><br><span class="line">Subscription: 1, event: Next(a)</span><br><span class="line">Subscription: 1, event: Next(b)</span><br><span class="line">Subscription: 2, event: Next(b)</span><br><span class="line">Subscription: 1, event: Next(c)</span><br><span class="line">Subscription: 2, event: Next(c)</span><br><span class="line">Subscription: 1, event: Next(d)</span><br><span class="line">Subscription: 2, event: Next(d)</span><br><span class="line">Subscription: 1, event: Completed</span><br><span class="line">Subscription: 2, event: Completed</span><br></pre></td></tr></table></figure>
<h2 id="变换操作"><a href="#变换操作" class="headerlink" title="变换操作"></a>变换操作</h2><p>下面列出了可用于对 Observable 发射的数据执行变换操作的各种操作符。</p>
<h3 id="map-select"><a href="#map-select" class="headerlink" title="map / select"></a><code>map</code> / <code>select</code></h3><p>对序列的每一项都应用一个函数来变换 Observable 发射的数据序列</p>
<p><img src="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/map.png" alt=""></p>
<p><a href="http://reactivex.io/documentation/operators/map.html" target="_blank" rel="noopener">更多相关内容请查看 reactive.io</a></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">example(<span class="string">"map"</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> originalSequence = <span class="type">Observable</span>.of(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">    <span class="number">_</span> = originalSequence</span><br><span class="line">        .<span class="built_in">map</span> &#123; number <span class="keyword">in</span></span><br><span class="line">            number * <span class="number">2</span></span><br><span class="line">        &#125;</span><br><span class="line">        .subscribe &#123; <span class="built_in">print</span>($<span class="number">0</span>) &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">--- map example ---</span><br><span class="line">Next(2)</span><br><span class="line">Next(4)</span><br><span class="line">Next(6)</span><br><span class="line">Completed</span><br></pre></td></tr></table></figure>
<h3 id="flatMap"><a href="#flatMap" class="headerlink" title="flatMap"></a><code>flatMap</code></h3><p>将每个 Obserable 发射的数据变换为 Observable 的集合，然后将其 “拍扁”（降维 flatten）成一个 Observable。</p>
<p><img src="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/flatmap.png" alt=""></p>
<p><a href="http://reactivex.io/documentation/operators/flatmap.html" target="_blank" rel="noopener">更多相关内容请查看 reactive.io</a></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">example(<span class="string">"flatMap"</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> sequenceInt = <span class="type">Observable</span>.of(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> sequenceString = <span class="type">Observable</span>.of(<span class="string">"A"</span>, <span class="string">"B"</span>, <span class="string">"C"</span>, <span class="string">"D"</span>, <span class="string">"E"</span>, <span class="string">"F"</span>, <span class="string">"--"</span>)</span><br><span class="line"></span><br><span class="line">    <span class="number">_</span> = sequenceInt</span><br><span class="line">        .flatMap &#123; (x:<span class="type">Int</span>) -&gt; <span class="type">Observable</span>&lt;<span class="type">String</span>&gt; <span class="keyword">in</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"from sequenceInt \(x)"</span>)</span><br><span class="line">            <span class="keyword">return</span> sequenceString</span><br><span class="line">        &#125;</span><br><span class="line">        .subscribe &#123;</span><br><span class="line">            <span class="built_in">print</span>($<span class="number">0</span>)</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">--- flatMap example ---</span><br><span class="line">from sequenceInt 1</span><br><span class="line">Next(A)</span><br><span class="line">Next(B)</span><br><span class="line">Next(C)</span><br><span class="line">Next(D)</span><br><span class="line">Next(E)</span><br><span class="line">Next(F)</span><br><span class="line">Next(--)</span><br><span class="line">from sequenceInt 2</span><br><span class="line">Next(A)</span><br><span class="line">Next(B)</span><br><span class="line">Next(C)</span><br><span class="line">Next(D)</span><br><span class="line">Next(E)</span><br><span class="line">Next(F)</span><br><span class="line">Next(--)</span><br><span class="line">from sequenceInt 3</span><br><span class="line">Next(A)</span><br><span class="line">Next(B)</span><br><span class="line">Next(C)</span><br><span class="line">Next(D)</span><br><span class="line">Next(E)</span><br><span class="line">Next(F)</span><br><span class="line">Next(--)</span><br><span class="line">Completed</span><br></pre></td></tr></table></figure>
<h3 id="scan"><a href="#scan" class="headerlink" title="scan"></a><code>scan</code></h3><p>对 Observable 发射的每一项数据应用一个函数，然后按顺序依次发射每一个值</p>
<p><img src="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/scan.png" alt=""></p>
<p><a href="http://reactivex.io/documentation/operators/scan.html" target="_blank" rel="noopener">更多相关内容请查看 reactive.io</a></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">example(<span class="string">"scan"</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> sequenceToSum = <span class="type">Observable</span>.of(<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">    <span class="number">_</span> = sequenceToSum</span><br><span class="line">        .scan(<span class="number">0</span>) &#123; acum, elem <span class="keyword">in</span></span><br><span class="line">            acum + elem</span><br><span class="line">        &#125;</span><br><span class="line">        .subscribe &#123;</span><br><span class="line">            <span class="built_in">print</span>($<span class="number">0</span>)</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">--- scan example ---</span><br><span class="line">Next(0)</span><br><span class="line">Next(1)</span><br><span class="line">Next(3)</span><br><span class="line">Next(6)</span><br><span class="line">Next(10)</span><br><span class="line">Next(15)</span><br><span class="line">Completed</span><br></pre></td></tr></table></figure>
<h2 id="过滤操作"><a href="#过滤操作" class="headerlink" title="过滤操作"></a>过滤操作</h2><p>从源 Observable 中选择特定的数据发送</p>
<h3 id="filter"><a href="#filter" class="headerlink" title="filter"></a><code>filter</code></h3><p>只发送 Observable 中通过特定测试的数据</p>
<p><img src="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/filter.png" alt=""></p>
<p><a href="http://reactivex.io/documentation/operators/filter.html" target="_blank" rel="noopener">更多相关内容请查看 reactive.io</a></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">example(<span class="string">"filter"</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> subscription = <span class="type">Observable</span>.of(<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>)</span><br><span class="line">        .<span class="built_in">filter</span> &#123;</span><br><span class="line">            $<span class="number">0</span> % <span class="number">2</span> == <span class="number">0</span></span><br><span class="line">        &#125;</span><br><span class="line">        .subscribe &#123;</span><br><span class="line">            <span class="built_in">print</span>($<span class="number">0</span>)</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">--- filter example ---</span><br><span class="line">Next(0)</span><br><span class="line">Next(2)</span><br><span class="line">Next(4)</span><br><span class="line">Next(6)</span><br><span class="line">Next(8)</span><br><span class="line">Completed</span><br></pre></td></tr></table></figure>
<h3 id="distinctUntilChanged"><a href="#distinctUntilChanged" class="headerlink" title="distinctUntilChanged"></a><code>distinctUntilChanged</code></h3><p>过滤掉连续重复的数据</p>
<p><img src="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/distinct.png" alt=""></p>
<p><a href="http://reactivex.io/documentation/operators/distinct.html" target="_blank" rel="noopener">更多相关内容请查看 reactive.io</a></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">example(<span class="string">"distinctUntilChanged"</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> subscription = <span class="type">Observable</span>.of(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">4</span>)</span><br><span class="line">        .distinctUntilChanged()</span><br><span class="line">        .subscribe &#123;</span><br><span class="line">            <span class="built_in">print</span>($<span class="number">0</span>)</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">--- distinctUntilChanged example ---</span><br><span class="line">Next(1)</span><br><span class="line">Next(2)</span><br><span class="line">Next(3)</span><br><span class="line">Next(1)</span><br><span class="line">Next(4)</span><br><span class="line">Completed</span><br></pre></td></tr></table></figure>
<h3 id="take"><a href="#take" class="headerlink" title="take"></a><code>take</code></h3><p>仅发送 Observable 的前 n 个数据项</p>
<p><img src="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/take.png" alt=""></p>
<p><a href="http://reactivex.io/documentation/operators/take.html" target="_blank" rel="noopener">更多相关内容请查看 reactive.io</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">example(&quot;take&quot;) &#123;</span><br><span class="line">    let subscription = Observable.of(1, 2, 3, 4, 5, 6)</span><br><span class="line">        .take(3)</span><br><span class="line">        .subscribe &#123;</span><br><span class="line">            print($0)</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">--- take example ---</span><br><span class="line">Next(1)</span><br><span class="line">Next(2)</span><br><span class="line">Next(3)</span><br><span class="line">Completed</span><br></pre></td></tr></table></figure>
<h2 id="结合操作-Combination-operators"><a href="#结合操作-Combination-operators" class="headerlink" title="结合操作(Combination operators)"></a>结合操作(Combination operators)</h2><p>将多个 Observable 结合成一个 Observable</p>
<h3 id="startWith"><a href="#startWith" class="headerlink" title="startWith"></a><code>startWith</code></h3><p>在数据序列的开头增加一些数据</p>
<p><img src="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/startwith.png" alt=""></p>
<p><a href="http://reactivex.io/documentation/operators/startwith.html" target="_blank" rel="noopener">更多相关内容请查看 reactive.io</a></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">example(<span class="string">"startWith"</span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> subscription = <span class="type">Observable</span>.of(<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>)</span><br><span class="line">        .startWith(<span class="number">3</span>)</span><br><span class="line">        .startWith(<span class="number">2</span>)</span><br><span class="line">        .startWith(<span class="number">1</span>)</span><br><span class="line">        .startWith(<span class="number">0</span>)</span><br><span class="line">        .subscribe &#123;</span><br><span class="line">            <span class="built_in">print</span>($<span class="number">0</span>)</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">--- startWith example ---</span><br><span class="line">Next(0)</span><br><span class="line">Next(1)</span><br><span class="line">Next(2)</span><br><span class="line">Next(3)</span><br><span class="line">Next(4)</span><br><span class="line">Next(5)</span><br><span class="line">Next(6)</span><br><span class="line">Next(7)</span><br><span class="line">Next(8)</span><br><span class="line">Next(9)</span><br><span class="line">Completed</span><br></pre></td></tr></table></figure>
<h3 id="combineLatest"><a href="#combineLatest" class="headerlink" title="combineLatest"></a><code>combineLatest</code></h3><p>当两个 Observables 中的任何一个发射了一个数据时，通过一个指定的函数组合每个Observable发射的最新数据（一共两个数据），然后发射这个函数的结果</p>
<p><img src="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/combinelatest.png" alt=""></p>
<p><a href="http://reactivex.io/documentation/operators/combinelatest.html" target="_blank" rel="noopener">更多相关内容请查看 reactive.io</a></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">example(<span class="string">"combineLatest 1"</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> intOb1 = <span class="type">PublishSubject</span>&lt;<span class="type">String</span>&gt;()</span><br><span class="line">    <span class="keyword">let</span> intOb2 = <span class="type">PublishSubject</span>&lt;<span class="type">Int</span>&gt;()</span><br><span class="line"></span><br><span class="line">    <span class="number">_</span> = <span class="type">Observable</span>.combineLatest(intOb1, intOb2) &#123;</span><br><span class="line">        <span class="string">"\($0) \($1)"</span></span><br><span class="line">        &#125;</span><br><span class="line">        .subscribe &#123;</span><br><span class="line">            <span class="built_in">print</span>($<span class="number">0</span>)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    intOb1.on(.<span class="type">Next</span>(<span class="string">"A"</span>))</span><br><span class="line"></span><br><span class="line">    intOb2.on(.<span class="type">Next</span>(<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">    intOb1.on(.<span class="type">Next</span>(<span class="string">"B"</span>))</span><br><span class="line"></span><br><span class="line">    intOb2.on(.<span class="type">Next</span>(<span class="number">2</span>))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">--- combineLatest 1 example ---</span><br><span class="line">Next(A 1)</span><br><span class="line">Next(B 1)</span><br><span class="line">Next(B 2)</span><br></pre></td></tr></table></figure>
<p>为了能够产生结果，两个序列中都必须保证至少有一个元素</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">example(<span class="string">"combineLatest 2"</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> intOb1 = <span class="type">Observable</span>.just(<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">let</span> intOb2 = <span class="type">Observable</span>.of(<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">    <span class="number">_</span> = <span class="type">Observable</span>.combineLatest(intOb1, intOb2) &#123;</span><br><span class="line">            $<span class="number">0</span> * $<span class="number">1</span></span><br><span class="line">        &#125;</span><br><span class="line">        .subscribe &#123;</span><br><span class="line">            <span class="built_in">print</span>($<span class="number">0</span>)</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">--- combineLatest 2 example ---</span><br><span class="line">Next(0)</span><br><span class="line">Next(2)</span><br><span class="line">Next(4)</span><br><span class="line">Next(6)</span><br><span class="line">Next(8)</span><br><span class="line">Completed</span><br></pre></td></tr></table></figure>
<p>Combine latest 有超过 2 个参数的版本</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">example(<span class="string">"combineLatest 3"</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> intOb1 = <span class="type">Observable</span>.just(<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">let</span> intOb2 = <span class="type">Observable</span>.of(<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line">    <span class="keyword">let</span> intOb3 = <span class="type">Observable</span>.of(<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">    <span class="number">_</span> = <span class="type">Observable</span>.combineLatest(intOb1, intOb2, intOb3) &#123;</span><br><span class="line">            ($<span class="number">0</span> + $<span class="number">1</span>) * $<span class="number">2</span></span><br><span class="line">        &#125;</span><br><span class="line">        .subscribe &#123;</span><br><span class="line">            <span class="built_in">print</span>($<span class="number">0</span>)</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">--- combineLatest 3 example ---</span><br><span class="line">Next(0)</span><br><span class="line">Next(5)</span><br><span class="line">Next(10)</span><br><span class="line">Next(15)</span><br><span class="line">Next(20)</span><br><span class="line">Completed</span><br></pre></td></tr></table></figure>
<p>Combinelatest 可以作用于不同数据类型的序列</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">example(<span class="string">"combineLatest 4"</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> intOb = <span class="type">Observable</span>.just(<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">let</span> stringOb = <span class="type">Observable</span>.just(<span class="string">"a"</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="number">_</span> = <span class="type">Observable</span>.combineLatest(intOb, stringOb) &#123;</span><br><span class="line">            <span class="string">"\($0) "</span> + $<span class="number">1</span></span><br><span class="line">        &#125;</span><br><span class="line">        .subscribe &#123;</span><br><span class="line">            <span class="built_in">print</span>($<span class="number">0</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">--- combineLatest 4 example ---</span><br><span class="line">Next(2 a)</span><br><span class="line">Completed</span><br></pre></td></tr></table></figure>
<p><code>combineLatest</code> 方法可以在 Array 上使用，数组元素类型必须遵循 <code>ObservableType</code> 协议<br>数组中的元素类型必须为 <code>Observables</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">example(<span class="string">"combineLatest 5"</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> intOb1 = <span class="type">Observable</span>.just(<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">let</span> intOb2 = <span class="type">Observable</span>.of(<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line">    <span class="keyword">let</span> intOb3 = <span class="type">Observable</span>.of(<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="number">_</span> = [intOb1, intOb2, intOb3].combineLatest &#123; intArray -&gt; <span class="type">Int</span> <span class="keyword">in</span></span><br><span class="line">            <span class="type">Int</span>((intArray[<span class="number">0</span>] + intArray[<span class="number">1</span>]) * intArray[<span class="number">2</span>])</span><br><span class="line">        &#125;</span><br><span class="line">        .subscribe &#123; (event: <span class="type">Event</span>&lt;<span class="type">Int</span>&gt;) -&gt; <span class="type">Void</span> <span class="keyword">in</span></span><br><span class="line">            <span class="built_in">print</span>(event)</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="zip"><a href="#zip" class="headerlink" title="zip"></a><code>zip</code></h3><p>使用一个函数组合多个Observable发射的数据集合，然后再发射这个结果(从序列中依次取数据)</p>
<p><img src="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/zip.png" alt=""></p>
<p><a href="http://reactivex.io/documentation/operators/zip.html" target="_blank" rel="noopener">更多相关内容请查看 reactive.io</a></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">example(<span class="string">"zip 1"</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> intOb1 = <span class="type">PublishSubject</span>&lt;<span class="type">String</span>&gt;()</span><br><span class="line">    <span class="keyword">let</span> intOb2 = <span class="type">PublishSubject</span>&lt;<span class="type">Int</span>&gt;()</span><br><span class="line"></span><br><span class="line">    <span class="number">_</span> = <span class="type">Observable</span>.<span class="built_in">zip</span>(intOb1, intOb2) &#123;</span><br><span class="line">        <span class="string">"\($0) \($1)"</span></span><br><span class="line">        &#125;</span><br><span class="line">        .subscribe &#123;</span><br><span class="line">            <span class="built_in">print</span>($<span class="number">0</span>)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    intOb1.on(.<span class="type">Next</span>(<span class="string">"A"</span>))</span><br><span class="line"></span><br><span class="line">    intOb2.on(.<span class="type">Next</span>(<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">    intOb1.on(.<span class="type">Next</span>(<span class="string">"B"</span>))</span><br><span class="line"></span><br><span class="line">    intOb1.on(.<span class="type">Next</span>(<span class="string">"C"</span>))</span><br><span class="line"></span><br><span class="line">    intOb2.on(.<span class="type">Next</span>(<span class="number">2</span>))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">--- zip 1 example ---</span><br><span class="line">Next(A 1)</span><br><span class="line">Next(B 2)</span><br></pre></td></tr></table></figure>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">example(<span class="string">"zip 2"</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> intOb1 = <span class="type">Observable</span>.just(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> intOb2 = <span class="type">Observable</span>.of(<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">    <span class="number">_</span> = <span class="type">Observable</span>.<span class="built_in">zip</span>(intOb1, intOb2) &#123;</span><br><span class="line">            $<span class="number">0</span> * $<span class="number">1</span></span><br><span class="line">        &#125;</span><br><span class="line">        .subscribe &#123;</span><br><span class="line">            <span class="built_in">print</span>($<span class="number">0</span>)</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">--- zip 2 example ---</span><br><span class="line">Next(0)</span><br><span class="line">Completed</span><br></pre></td></tr></table></figure>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">example(<span class="string">"zip 3"</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> intOb1 = <span class="type">Observable</span>.of(<span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">let</span> intOb2 = <span class="type">Observable</span>.of(<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line">    <span class="keyword">let</span> intOb3 = <span class="type">Observable</span>.of(<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">    <span class="number">_</span> = <span class="type">Observable</span>.<span class="built_in">zip</span>(intOb1, intOb2, intOb3) &#123;</span><br><span class="line">            ($<span class="number">0</span> + $<span class="number">1</span>) * $<span class="number">2</span></span><br><span class="line">        &#125;</span><br><span class="line">        .subscribe &#123;</span><br><span class="line">            <span class="built_in">print</span>($<span class="number">0</span>)</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">--- zip 3 example ---</span><br><span class="line">Next(0)</span><br><span class="line">Next(2)</span><br><span class="line">Completed</span><br></pre></td></tr></table></figure>
<h3 id="merge"><a href="#merge" class="headerlink" title="merge"></a><code>merge</code></h3><p>合并多个 Observables 的组合成一个</p>
<p><img src="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/merge.png" alt=""></p>
<p><a href="http://reactivex.io/documentation/operators/merge.html" target="_blank" rel="noopener">更多相关内容请查看 reactive.io</a></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">example(<span class="string">"merge 1"</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> subject1 = <span class="type">PublishSubject</span>&lt;<span class="type">Int</span>&gt;()</span><br><span class="line">    <span class="keyword">let</span> subject2 = <span class="type">PublishSubject</span>&lt;<span class="type">Int</span>&gt;()</span><br><span class="line"></span><br><span class="line">    <span class="number">_</span> = <span class="type">Observable</span>.of(subject1, subject2)</span><br><span class="line">        .merge()</span><br><span class="line">        .subscribeNext &#123; int <span class="keyword">in</span></span><br><span class="line">            <span class="built_in">print</span>(int)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    subject1.on(.<span class="type">Next</span>(<span class="number">20</span>))</span><br><span class="line">    subject1.on(.<span class="type">Next</span>(<span class="number">40</span>))</span><br><span class="line">    subject1.on(.<span class="type">Next</span>(<span class="number">60</span>))</span><br><span class="line">    subject2.on(.<span class="type">Next</span>(<span class="number">1</span>))</span><br><span class="line">    subject1.on(.<span class="type">Next</span>(<span class="number">80</span>))</span><br><span class="line">    subject1.on(.<span class="type">Next</span>(<span class="number">100</span>))</span><br><span class="line">    subject2.on(.<span class="type">Next</span>(<span class="number">1</span>))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">--- merge 1 example ---</span><br><span class="line">20</span><br><span class="line">40</span><br><span class="line">60</span><br><span class="line">1</span><br><span class="line">80</span><br><span class="line">100</span><br><span class="line">1</span><br></pre></td></tr></table></figure>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">example(<span class="string">"merge 2"</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> subject1 = <span class="type">PublishSubject</span>&lt;<span class="type">Int</span>&gt;()</span><br><span class="line">    <span class="keyword">let</span> subject2 = <span class="type">PublishSubject</span>&lt;<span class="type">Int</span>&gt;()</span><br><span class="line"></span><br><span class="line">    <span class="number">_</span> = <span class="type">Observable</span>.of(subject1, subject2)</span><br><span class="line">        .merge(maxConcurrent: <span class="number">2</span>)</span><br><span class="line">        .subscribe &#123;</span><br><span class="line">            <span class="built_in">print</span>($<span class="number">0</span>)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    subject1.on(.<span class="type">Next</span>(<span class="number">20</span>))</span><br><span class="line">    subject1.on(.<span class="type">Next</span>(<span class="number">40</span>))</span><br><span class="line">    subject1.on(.<span class="type">Next</span>(<span class="number">60</span>))</span><br><span class="line">    subject2.on(.<span class="type">Next</span>(<span class="number">1</span>))</span><br><span class="line">    subject1.on(.<span class="type">Next</span>(<span class="number">80</span>))</span><br><span class="line">    subject1.on(.<span class="type">Next</span>(<span class="number">100</span>))</span><br><span class="line">    subject2.on(.<span class="type">Next</span>(<span class="number">1</span>))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">--- merge 2 example ---</span><br><span class="line">Next(20)</span><br><span class="line">Next(40)</span><br><span class="line">Next(60)</span><br><span class="line">Next(1)</span><br><span class="line">Next(80)</span><br><span class="line">Next(100)</span><br><span class="line">Next(1)</span><br></pre></td></tr></table></figure>
<h3 id="switchLatest"><a href="#switchLatest" class="headerlink" title="switchLatest"></a><code>switchLatest</code></h3><p>将一个发射多个 Observables 的 Observable 转换成另一个单独的 Observable，后者发射那些 Observables 最近发射的数据项</p>
<p>Switch 订阅一个发射多个 Observables 的 Observable。它每次观察那些 Observables 中的一个，Switch 返回的这个Observable取消订阅前一个发射数据的 Observable，开始发射最近的Observable 发射的数据。注意：当原始 Observable 发射了一个新的 Observable 时（不是这个新的 Observable 发射了一条数据时），它将取消订阅之前的那个 Observable。这意味着，在后来那个 Observable 产生之后到它开始发射数据之前的这段时间里，前一个 Observable 发射的数据将被丢弃</p>
<p><img src="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/switch.png" alt=""></p>
<p><a href="http://reactivex.io/documentation/operators/switch.html" target="_blank" rel="noopener">更多相关内容请查看 reactive.io</a></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">example(<span class="string">"switchLatest"</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> var1 = <span class="type">Variable</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> var2 = <span class="type">Variable</span>(<span class="number">200</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// var3 is like an Observable&lt;Observable&lt;Int&gt;&gt;</span></span><br><span class="line">    <span class="keyword">let</span> var3 = <span class="type">Variable</span>(var1.asObservable())</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> d = var3</span><br><span class="line">        .asObservable()</span><br><span class="line">        .switchLatest()</span><br><span class="line">        .subscribe &#123;</span><br><span class="line">            <span class="built_in">print</span>($<span class="number">0</span>)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    var1.value = <span class="number">1</span></span><br><span class="line">    var1.value = <span class="number">2</span></span><br><span class="line">    var1.value = <span class="number">3</span></span><br><span class="line">    var1.value = <span class="number">4</span></span><br><span class="line"></span><br><span class="line">    var3.value = var2.asObservable()</span><br><span class="line"></span><br><span class="line">    var2.value = <span class="number">201</span></span><br><span class="line"></span><br><span class="line">    var1.value = <span class="number">5</span></span><br><span class="line">    var1.value = <span class="number">6</span></span><br><span class="line">    var1.value = <span class="number">7</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">--- switchLatest example ---</span><br><span class="line">Next(0)</span><br><span class="line">Next(1)</span><br><span class="line">Next(2)</span><br><span class="line">Next(3)</span><br><span class="line">Next(4)</span><br><span class="line">Next(200)</span><br><span class="line">Next(201)</span><br><span class="line">Completed</span><br></pre></td></tr></table></figure>
<h2 id="Error-Handling-Operators"><a href="#Error-Handling-Operators" class="headerlink" title="Error Handling Operators"></a>Error Handling Operators</h2><p>下面的操作符帮助我们从 Observable 发射的 error 通知做出响应或者从错误中恢复。</p>
<h3 id="catchError"><a href="#catchError" class="headerlink" title="catchError"></a><code>catchError</code></h3><p>收到 <code>Error</code> 通知之后，转而发送一个没有错误的序列。</p>
<p><img src="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/catch.png" alt=""></p>
<p><a href="http://reactivex.io/documentation/operators/catch.html" target="_blank" rel="noopener">更多相关内容请查看 reactive.io</a></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">example(<span class="string">"catchError 1"</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> sequenceThatFails = <span class="type">PublishSubject</span>&lt;<span class="type">Int</span>&gt;()</span><br><span class="line">    <span class="keyword">let</span> recoverySequence = <span class="type">Observable</span>.of(<span class="number">100</span>, <span class="number">200</span>, <span class="number">300</span>, <span class="number">400</span>)</span><br><span class="line"></span><br><span class="line">    <span class="number">_</span> = sequenceThatFails</span><br><span class="line">        .catchError &#123; error <span class="keyword">in</span></span><br><span class="line">            <span class="keyword">return</span> recoverySequence</span><br><span class="line">        &#125;</span><br><span class="line">        .subscribe &#123;</span><br><span class="line">            <span class="built_in">print</span>($<span class="number">0</span>)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    sequenceThatFails.on(.<span class="type">Next</span>(<span class="number">1</span>))</span><br><span class="line">    sequenceThatFails.on(.<span class="type">Next</span>(<span class="number">2</span>))</span><br><span class="line">    sequenceThatFails.on(.<span class="type">Next</span>(<span class="number">3</span>))</span><br><span class="line">    sequenceThatFails.on(.<span class="type">Next</span>(<span class="number">4</span>))</span><br><span class="line">    sequenceThatFails.on(.<span class="type">Error</span>(<span class="type">NSError</span>(domain: <span class="string">"Test"</span>, code: <span class="number">0</span>, userInfo: <span class="literal">nil</span>)))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">--- catchError 1 example ---</span><br><span class="line">Next(1)</span><br><span class="line">Next(2)</span><br><span class="line">Next(3)</span><br><span class="line">Next(4)</span><br><span class="line">Next(100)</span><br><span class="line">Next(200)</span><br><span class="line">Next(300)</span><br><span class="line">Next(400)</span><br><span class="line">Completed</span><br></pre></td></tr></table></figure>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">example(<span class="string">"catchError 2"</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> sequenceThatFails = <span class="type">PublishSubject</span>&lt;<span class="type">Int</span>&gt;()</span><br><span class="line"></span><br><span class="line">    <span class="number">_</span> = sequenceThatFails</span><br><span class="line">        .catchErrorJustReturn(<span class="number">100</span>)</span><br><span class="line">        .subscribe &#123;</span><br><span class="line">            <span class="built_in">print</span>($<span class="number">0</span>)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    sequenceThatFails.on(.<span class="type">Next</span>(<span class="number">1</span>))</span><br><span class="line">    sequenceThatFails.on(.<span class="type">Next</span>(<span class="number">2</span>))</span><br><span class="line">    sequenceThatFails.on(.<span class="type">Next</span>(<span class="number">3</span>))</span><br><span class="line">    sequenceThatFails.on(.<span class="type">Next</span>(<span class="number">4</span>))</span><br><span class="line">    sequenceThatFails.on(.<span class="type">Error</span>(<span class="type">NSError</span>(domain: <span class="string">"Test"</span>, code: <span class="number">0</span>, userInfo: <span class="literal">nil</span>)))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">--- catchError 2 example ---</span><br><span class="line">Next(1)</span><br><span class="line">Next(2)</span><br><span class="line">Next(3)</span><br><span class="line">Next(4)</span><br><span class="line">Next(100)</span><br><span class="line">Completed</span><br></pre></td></tr></table></figure>
<h3 id="retry"><a href="#retry" class="headerlink" title="retry"></a><code>retry</code></h3><p>如果原始 Observable 遇到错误，重新订阅，心里默念，不会出错不会出错…</p>
<p><img src="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/retry.png" alt=""></p>
<p><a href="http://reactivex.io/documentation/operators/retry.html" target="_blank" rel="noopener">更多相关内容请查看 reactive.io</a></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">example(<span class="string">"retry"</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> <span class="built_in">count</span> = <span class="number">1</span> <span class="comment">// bad practice, only for example purposes</span></span><br><span class="line">    <span class="keyword">let</span> funnyLookingSequence = <span class="type">Observable</span>&lt;<span class="type">Int</span>&gt;.create &#123; observer <span class="keyword">in</span></span><br><span class="line">        <span class="keyword">let</span> error = <span class="type">NSError</span>(domain: <span class="string">"Test"</span>, code: <span class="number">0</span>, userInfo: <span class="literal">nil</span>)</span><br><span class="line">        observer.on(.<span class="type">Next</span>(<span class="number">0</span>))</span><br><span class="line">        observer.on(.<span class="type">Next</span>(<span class="number">1</span>))</span><br><span class="line">        observer.on(.<span class="type">Next</span>(<span class="number">2</span>))</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">count</span> &lt; <span class="number">2</span> &#123;</span><br><span class="line">            observer.on(.<span class="type">Error</span>(error))</span><br><span class="line">            <span class="built_in">count</span> += <span class="number">1</span></span><br><span class="line">        &#125;</span><br><span class="line">        observer.on(.<span class="type">Next</span>(<span class="number">3</span>))</span><br><span class="line">        observer.on(.<span class="type">Next</span>(<span class="number">4</span>))</span><br><span class="line">        observer.on(.<span class="type">Next</span>(<span class="number">5</span>))</span><br><span class="line">        observer.on(.<span class="type">Completed</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="type">NopDisposable</span>.instance</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="number">_</span> = funnyLookingSequence</span><br><span class="line">        .retry()</span><br><span class="line">        .subscribe &#123;</span><br><span class="line">            <span class="built_in">print</span>($<span class="number">0</span>)</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">--- retry example ---</span><br><span class="line">Next(0)</span><br><span class="line">Next(1)</span><br><span class="line">Next(2)</span><br><span class="line">Next(0)</span><br><span class="line">Next(1)</span><br><span class="line">Next(2)</span><br><span class="line">Next(3)</span><br><span class="line">Next(4)</span><br><span class="line">Next(5)</span><br><span class="line">Completed</span><br></pre></td></tr></table></figure>
<h2 id="Observable-Utility-Operators"><a href="#Observable-Utility-Operators" class="headerlink" title="Observable Utility Operators"></a>Observable Utility Operators</h2><p>下面的操作符可以当做一个工具集，方便操作 Observable</p>
<h3 id="subscribe"><a href="#subscribe" class="headerlink" title="subscribe"></a><code>subscribe</code></h3><p><a href="http://reactivex.io/documentation/operators/subscribe.html" target="_blank" rel="noopener">更多相关内容请查看 reactive.io</a></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">example(<span class="string">"subscribe"</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> sequenceOfInts = <span class="type">PublishSubject</span>&lt;<span class="type">Int</span>&gt;()</span><br><span class="line"></span><br><span class="line">    <span class="number">_</span> = sequenceOfInts</span><br><span class="line">        .subscribe &#123;</span><br><span class="line">            <span class="built_in">print</span>($<span class="number">0</span>)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    sequenceOfInts.on(.<span class="type">Next</span>(<span class="number">1</span>))</span><br><span class="line">    sequenceOfInts.on(.<span class="type">Completed</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">--- subscribe example ---</span><br><span class="line">Next(1)</span><br><span class="line">Completed</span><br></pre></td></tr></table></figure>
<p>下面是几个 <code>subscribe</code> 操作符的变体</p>
<h3 id="subscribeNext"><a href="#subscribeNext" class="headerlink" title="subscribeNext"></a><code>subscribeNext</code></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">example(<span class="string">"subscribeNext"</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> sequenceOfInts = <span class="type">PublishSubject</span>&lt;<span class="type">Int</span>&gt;()</span><br><span class="line"></span><br><span class="line">    <span class="number">_</span> = sequenceOfInts</span><br><span class="line">        .subscribeNext &#123;</span><br><span class="line">            <span class="built_in">print</span>($<span class="number">0</span>)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    sequenceOfInts.on(.<span class="type">Next</span>(<span class="number">1</span>))</span><br><span class="line">    sequenceOfInts.on(.<span class="type">Completed</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">--- subscribeNext example ---</span><br><span class="line">1</span><br></pre></td></tr></table></figure>
<h3 id="subscribeCompleted"><a href="#subscribeCompleted" class="headerlink" title="subscribeCompleted"></a><code>subscribeCompleted</code></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">example(<span class="string">"subscribeCompleted"</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> sequenceOfInts = <span class="type">PublishSubject</span>&lt;<span class="type">Int</span>&gt;()</span><br><span class="line"></span><br><span class="line">    <span class="number">_</span> = sequenceOfInts</span><br><span class="line">        .subscribeCompleted &#123;</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"It's completed"</span>)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    sequenceOfInts.on(.<span class="type">Next</span>(<span class="number">1</span>))</span><br><span class="line">    sequenceOfInts.on(.<span class="type">Completed</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">--- subscribeCompleted example ---</span><br><span class="line">It&apos;s completed</span><br></pre></td></tr></table></figure>
<h3 id="subscribeError"><a href="#subscribeError" class="headerlink" title="subscribeError"></a><code>subscribeError</code></h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">example(<span class="string">"subscribeError"</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> sequenceOfInts = <span class="type">PublishSubject</span>&lt;<span class="type">Int</span>&gt;()</span><br><span class="line"></span><br><span class="line">    <span class="number">_</span> = sequenceOfInts</span><br><span class="line">        .subscribeError &#123; error <span class="keyword">in</span></span><br><span class="line">            <span class="built_in">print</span>(error)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    sequenceOfInts.on(.<span class="type">Next</span>(<span class="number">1</span>))</span><br><span class="line">    sequenceOfInts.on(.<span class="type">Error</span>(<span class="type">NSError</span>(domain: <span class="string">"Examples"</span>, code: -<span class="number">1</span>, userInfo: <span class="literal">nil</span>)))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">--- subscribeError example ---</span><br><span class="line">Error Domain=Examples Code=-1 &quot;(null)&quot;</span><br></pre></td></tr></table></figure>
<h3 id="doOn"><a href="#doOn" class="headerlink" title="doOn"></a><code>doOn</code></h3><p>注册一个操作来监听事件的生命周期<br>（register an action to take upon a variety of Observable lifecycle events）</p>
<p><img src="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/do.png" alt=""></p>
<p><a href="http://reactivex.io/documentation/operators/do.html" target="_blank" rel="noopener">更多相关内容请查看 reactive.io</a></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">example(<span class="string">"doOn"</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> sequenceOfInts = <span class="type">PublishSubject</span>&lt;<span class="type">Int</span>&gt;()</span><br><span class="line"></span><br><span class="line">    <span class="number">_</span> = sequenceOfInts</span><br><span class="line">        .doOn &#123;</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"Intercepted event \($0)"</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        .subscribe &#123;</span><br><span class="line">            <span class="built_in">print</span>($<span class="number">0</span>)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    sequenceOfInts.on(.<span class="type">Next</span>(<span class="number">1</span>))</span><br><span class="line">    sequenceOfInts.on(.<span class="type">Completed</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">--- doOn example ---</span><br><span class="line">Intercepted event Next(1)</span><br><span class="line">Next(1)</span><br><span class="line">Intercepted event Completed</span><br><span class="line">Completed</span><br></pre></td></tr></table></figure>
<h2 id="条件和布尔操作（Conditional-and-Boolean-Operators）"><a href="#条件和布尔操作（Conditional-and-Boolean-Operators）" class="headerlink" title="条件和布尔操作（Conditional and Boolean Operators）"></a>条件和布尔操作（Conditional and Boolean Operators）</h2><p>下面的操作符可用于根据条件发射或变换 Observables，或者对它们做布尔运算：</p>
<h3 id="takeUntil"><a href="#takeUntil" class="headerlink" title="takeUntil"></a><code>takeUntil</code></h3><p>当第二个 Observable 发送数据之后，丢弃第一个 Observable 在这之后的所有消息。</p>
<p><img src="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/takeuntil.png" alt=""></p>
<p><a href="http://reactivex.io/documentation/operators/takeuntil.html" target="_blank" rel="noopener">更多相关内容请查看 reactive.io</a></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">example(<span class="string">"takeUntil"</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> originalSequence = <span class="type">PublishSubject</span>&lt;<span class="type">Int</span>&gt;()</span><br><span class="line">    <span class="keyword">let</span> whenThisSendsNextWorldStops = <span class="type">PublishSubject</span>&lt;<span class="type">Int</span>&gt;()</span><br><span class="line"></span><br><span class="line">    <span class="number">_</span> = originalSequence</span><br><span class="line">        .takeUntil(whenThisSendsNextWorldStops)</span><br><span class="line">        .subscribe &#123;</span><br><span class="line">            <span class="built_in">print</span>($<span class="number">0</span>)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    originalSequence.on(.<span class="type">Next</span>(<span class="number">1</span>))</span><br><span class="line">    originalSequence.on(.<span class="type">Next</span>(<span class="number">2</span>))</span><br><span class="line">    originalSequence.on(.<span class="type">Next</span>(<span class="number">3</span>))</span><br><span class="line">    originalSequence.on(.<span class="type">Next</span>(<span class="number">4</span>))</span><br><span class="line"></span><br><span class="line">    whenThisSendsNextWorldStops.on(.<span class="type">Next</span>(<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">    originalSequence.on(.<span class="type">Next</span>(<span class="number">5</span>))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">--- takeUntil example ---</span><br><span class="line">Next(1)</span><br><span class="line">Next(2)</span><br><span class="line">Next(3)</span><br><span class="line">Next(4)</span><br><span class="line">Completed</span><br></pre></td></tr></table></figure>
<h3 id="takeWhile"><a href="#takeWhile" class="headerlink" title="takeWhile"></a><code>takeWhile</code></h3><p>发送原始 Observable 的数据，直到一个特定的条件为 false</p>
<p><img src="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/takewhile.png" alt=""></p>
<p><a href="http://reactivex.io/documentation/operators/takewhile.html" target="_blank" rel="noopener">更多相关内容请查看 reactive.io</a></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">example(<span class="string">"takeWhile"</span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> sequence = <span class="type">PublishSubject</span>&lt;<span class="type">Int</span>&gt;()</span><br><span class="line"></span><br><span class="line">    <span class="number">_</span> = sequence</span><br><span class="line">        .takeWhile &#123; int <span class="keyword">in</span></span><br><span class="line">            int &lt; <span class="number">4</span></span><br><span class="line">        &#125;</span><br><span class="line">        .subscribe &#123;</span><br><span class="line">            <span class="built_in">print</span>($<span class="number">0</span>)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    sequence.on(.<span class="type">Next</span>(<span class="number">1</span>))</span><br><span class="line">    sequence.on(.<span class="type">Next</span>(<span class="number">2</span>))</span><br><span class="line">    sequence.on(.<span class="type">Next</span>(<span class="number">3</span>))</span><br><span class="line">    sequence.on(.<span class="type">Next</span>(<span class="number">4</span>))</span><br><span class="line">    sequence.on(.<span class="type">Next</span>(<span class="number">5</span>))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">--- takeWhile example ---</span><br><span class="line">Next(1)</span><br><span class="line">Next(2)</span><br><span class="line">Next(3)</span><br><span class="line">Completed</span><br></pre></td></tr></table></figure>
<h2 id="算数和聚合-Mathematical-and-Aggregate-Operators"><a href="#算数和聚合-Mathematical-and-Aggregate-Operators" class="headerlink" title="算数和聚合(Mathematical and Aggregate Operators)"></a>算数和聚合(Mathematical and Aggregate Operators)</h2><h3 id="concat"><a href="#concat" class="headerlink" title="concat"></a><code>concat</code></h3><p>合并两个或者以上的 Observable 的消息，并且这些消息的发送时间不会交叉。（队列先后顺序不会交叉）</p>
<p><img src="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/concat.png" alt=""></p>
<p><a href="http://reactivex.io/documentation/operators/concat.html" target="_blank" rel="noopener">更多相关内容请查看 reactive.io</a></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">example(<span class="string">"concat"</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> var1 = <span class="type">BehaviorSubject</span>(value: <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">let</span> var2 = <span class="type">BehaviorSubject</span>(value: <span class="number">200</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// var3 is like an Observable&lt;Observable&lt;Int&gt;&gt;</span></span><br><span class="line">    <span class="keyword">let</span> var3 = <span class="type">BehaviorSubject</span>(value: var1)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> d = var3</span><br><span class="line">        .concat()</span><br><span class="line">        .subscribe &#123;</span><br><span class="line">            <span class="built_in">print</span>($<span class="number">0</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    </span><br><span class="line">    var1.on(.<span class="type">Next</span>(<span class="number">1</span>))</span><br><span class="line">    var1.on(.<span class="type">Next</span>(<span class="number">2</span>))</span><br><span class="line">    var1.on(.<span class="type">Next</span>(<span class="number">3</span>))</span><br><span class="line">    var1.on(.<span class="type">Next</span>(<span class="number">4</span>))</span><br><span class="line">    </span><br><span class="line">    var3.on(.<span class="type">Next</span>(var2))</span><br><span class="line">    </span><br><span class="line">    var2.on(.<span class="type">Next</span>(<span class="number">201</span>))</span><br><span class="line">    </span><br><span class="line">    var1.on(.<span class="type">Next</span>(<span class="number">5</span>))</span><br><span class="line">    var1.on(.<span class="type">Next</span>(<span class="number">6</span>))</span><br><span class="line">    var1.on(.<span class="type">Next</span>(<span class="number">7</span>))</span><br><span class="line">    var1.on(.<span class="type">Completed</span>)</span><br><span class="line">    </span><br><span class="line">    var2.on(.<span class="type">Next</span>(<span class="number">202</span>))</span><br><span class="line">    var2.on(.<span class="type">Next</span>(<span class="number">203</span>))</span><br><span class="line">    var2.on(.<span class="type">Next</span>(<span class="number">204</span>))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">--- concat example ---</span><br><span class="line">Next(0)</span><br><span class="line">Next(1)</span><br><span class="line">Next(2)</span><br><span class="line">Next(3)</span><br><span class="line">Next(4)</span><br><span class="line">Next(5)</span><br><span class="line">Next(6)</span><br><span class="line">Next(7)</span><br><span class="line">Next(201)</span><br><span class="line">Next(202)</span><br><span class="line">Next(203)</span><br><span class="line">Next(204)</span><br></pre></td></tr></table></figure>
<h3 id="reduce"><a href="#reduce" class="headerlink" title="reduce"></a><code>reduce</code></h3><p>按顺序对Observable发射的每项数据应用一个函数并发射最终的值。<br><code>Reduce</code> 操作符对原始 Observable 发射数据的第一项应用一个函数，然后再将这个函数的返回值与第二项数据一起传递给函数，以此类推，持续这个过程知道原始Observable发射它的最后一项数据并终止，此时 Reduce 返回的 Observable 发射这个函数返回的最终值。与数组序列的 <code>reduce</code> 操作类似。</p>
<p><img src="https://raw.githubusercontent.com/kzaher/rxswiftcontent/master/MarbleDiagrams/png/reduce.png" alt=""></p>
<p><a href="http://reactivex.io/documentation/operators/reduce.html" target="_blank" rel="noopener">更多相关内容请查看 reactive.io</a></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">example(<span class="string">"reduce"</span>) &#123;</span><br><span class="line">    <span class="number">_</span> = <span class="type">Observable</span>.of(<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>)</span><br><span class="line">        .<span class="built_in">reduce</span>(<span class="number">0</span>, accumulator: +)</span><br><span class="line">        .subscribe &#123;</span><br><span class="line">            <span class="built_in">print</span>($<span class="number">0</span>)</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">--- reduce example ---</span><br><span class="line">Next(45)</span><br><span class="line">Completed</span><br></pre></td></tr></table></figure>

      
    </div>
    
    
    

    

    
      <div>
        <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
  <div>如果这篇文章帮助您解决了问题，可以考虑请我喝杯咖啡</div>
  <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
    <span>打赏</span>
  </button>
  <div id="QR" style="display: none;">

    
      <div id="wechat" style="display: inline-block">
        <img id="wechat_qr" src="http://futantan.qiniudn.com/wechat_pay.JPG" alt="Prayer 微信支付"/>
        <p>微信支付</p>
      </div>
    

    

    

  </div>
</div>

      </div>
    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/RxSwift/" rel="tag"># RxSwift</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2016/05/03/Learn-RxSwift-The-Hard-Way-Calculator/" rel="next" title="Learn RxSwift The Hard Way - Calculator (二)">
                <i class="fa fa-chevron-left"></i> Learn RxSwift The Hard Way - Calculator (二)
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2016/06/03/Learn-RxSwift-The-Hard-Way-Geolocation/" rel="prev" title="Learn RxSwift The Hard Way - Geolocation (三)">
                Learn RxSwift The Hard Way - Geolocation (三) <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
      <div id="disqus_thread">
        <noscript>
          Please enable JavaScript to view the
          <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
        </noscript>
      </div>
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="https://avatars2.githubusercontent.com/u/6268441"
                alt="Prayer" />
            
              <p class="site-author-name" itemprop="name">Prayer</p>
              <p class="site-description motion-element" itemprop="description">DO COOL THINGS THAT MATTER</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">39</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">9</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">25</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          <div class="links-of-author motion-element">
            
              
                <span class="links-of-author-item">
                  <a href="https://github.com/futantan" target="_blank" title="GitHub">
                    
                      <i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
                <span class="links-of-author-item">
                  <a href="https://twitter.com/EclipsePrayer" target="_blank" title="Twitter">
                    
                      <i class="fa fa-fw fa-twitter"></i>Twitter</a>
                </span>
              
                <span class="links-of-author-item">
                  <a href="http://weibo.com/EclipsePrayer" target="_blank" title="Weibo">
                    
                      <i class="fa fa-fw fa-weibo"></i>Weibo</a>
                </span>
              
                <span class="links-of-author-item">
                  <a href="mailto:yourname@gmail.com" target="_blank" title="E-Mail">
                    
                      <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                </span>
              
            
          </div>

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-inline">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                小伙伴们
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="http://xiaolei.tech/" title="巅峰博士" target="_blank">巅峰博士</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://numbbbbb.com" title="梁杰" target="_blank">梁杰</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://ijack.pw" title="Jack Alan" target="_blank">Jack Alan</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://www.saitjr.com" title="Sai" target="_blank">Sai</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://www.swiftyper.com" title="小锅" target="_blank">小锅</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://www.justzht.com" title="JustZht" target="_blank">JustZht</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://sergiochan.xyz" title="Sergio Chan" target="_blank">Sergio Chan</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://www.martinrgb.com" title="MartinRGB" target="_blank">MartinRGB</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="blog.dianqk.org" title="DianQK" target="_blank">DianQK</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://blog.cee.moe" title="Cee" target="_blank">Cee</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://swift.gg" title="SwiftGG" target="_blank">SwiftGG</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://yoyoyohamapi.me" title="吴小虫" target="_blank">吴小虫</a>
                  </li>
                
              </ul>
            </div>
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Introduction"><span class="nav-number">1.</span> <span class="nav-text">Introduction</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#为什么使用-RxSwift"><span class="nav-number">1.1.</span> <span class="nav-text">为什么使用 RxSwift?</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Observable"><span class="nav-number">1.2.</span> <span class="nav-text">Observable</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#创建和订阅-Observable"><span class="nav-number">1.3.</span> <span class="nav-text">创建和订阅 Observable</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#empty"><span class="nav-number">1.3.1.</span> <span class="nav-text">empty</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#never"><span class="nav-number">1.3.2.</span> <span class="nav-text">never</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#just"><span class="nav-number">1.3.3.</span> <span class="nav-text">just</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#sequenceOf"><span class="nav-number">1.3.4.</span> <span class="nav-text">sequenceOf</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#toObservable"><span class="nav-number">1.3.5.</span> <span class="nav-text">toObservable</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#create"><span class="nav-number">1.3.6.</span> <span class="nav-text">create</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#generate"><span class="nav-number">1.3.7.</span> <span class="nav-text">generate</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#error"><span class="nav-number">1.3.8.</span> <span class="nav-text">error</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#deferred"><span class="nav-number">1.3.9.</span> <span class="nav-text">deferred</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Subjects"><span class="nav-number">2.</span> <span class="nav-text">Subjects</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#PublishSubject"><span class="nav-number">2.1.</span> <span class="nav-text">PublishSubject</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ReplaySubject"><span class="nav-number">2.2.</span> <span class="nav-text">ReplaySubject</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#BehaviorSubject"><span class="nav-number">2.3.</span> <span class="nav-text">BehaviorSubject</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Variable"><span class="nav-number">2.4.</span> <span class="nav-text">Variable</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#变换操作"><span class="nav-number">2.5.</span> <span class="nav-text">变换操作</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#map-select"><span class="nav-number">2.5.1.</span> <span class="nav-text">map / select</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#flatMap"><span class="nav-number">2.5.2.</span> <span class="nav-text">flatMap</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#scan"><span class="nav-number">2.5.3.</span> <span class="nav-text">scan</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#过滤操作"><span class="nav-number">2.6.</span> <span class="nav-text">过滤操作</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#filter"><span class="nav-number">2.6.1.</span> <span class="nav-text">filter</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#distinctUntilChanged"><span class="nav-number">2.6.2.</span> <span class="nav-text">distinctUntilChanged</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#take"><span class="nav-number">2.6.3.</span> <span class="nav-text">take</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#结合操作-Combination-operators"><span class="nav-number">2.7.</span> <span class="nav-text">结合操作(Combination operators)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#startWith"><span class="nav-number">2.7.1.</span> <span class="nav-text">startWith</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#combineLatest"><span class="nav-number">2.7.2.</span> <span class="nav-text">combineLatest</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#zip"><span class="nav-number">2.7.3.</span> <span class="nav-text">zip</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#merge"><span class="nav-number">2.7.4.</span> <span class="nav-text">merge</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#switchLatest"><span class="nav-number">2.7.5.</span> <span class="nav-text">switchLatest</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Error-Handling-Operators"><span class="nav-number">2.8.</span> <span class="nav-text">Error Handling Operators</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#catchError"><span class="nav-number">2.8.1.</span> <span class="nav-text">catchError</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#retry"><span class="nav-number">2.8.2.</span> <span class="nav-text">retry</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Observable-Utility-Operators"><span class="nav-number">2.9.</span> <span class="nav-text">Observable Utility Operators</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#subscribe"><span class="nav-number">2.9.1.</span> <span class="nav-text">subscribe</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#subscribeNext"><span class="nav-number">2.9.2.</span> <span class="nav-text">subscribeNext</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#subscribeCompleted"><span class="nav-number">2.9.3.</span> <span class="nav-text">subscribeCompleted</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#subscribeError"><span class="nav-number">2.9.4.</span> <span class="nav-text">subscribeError</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#doOn"><span class="nav-number">2.9.5.</span> <span class="nav-text">doOn</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#条件和布尔操作（Conditional-and-Boolean-Operators）"><span class="nav-number">2.10.</span> <span class="nav-text">条件和布尔操作（Conditional and Boolean Operators）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#takeUntil"><span class="nav-number">2.10.1.</span> <span class="nav-text">takeUntil</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#takeWhile"><span class="nav-number">2.10.2.</span> <span class="nav-text">takeWhile</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#算数和聚合-Mathematical-and-Aggregate-Operators"><span class="nav-number">2.11.</span> <span class="nav-text">算数和聚合(Mathematical and Aggregate Operators)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#concat"><span class="nav-number">2.11.1.</span> <span class="nav-text">concat</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#reduce"><span class="nav-number">2.11.2.</span> <span class="nav-text">reduce</span></a></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2014 &mdash; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Prayer</span>

  
</div>









        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.3"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.3"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.3"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  

    
      <script id="dsq-count-scr" src="https://futantan.disqus.com/count.js" async></script>
    

    
      <script type="text/javascript">
        var disqus_config = function () {
          this.page.url = 'http://www.futantan.com/2016/05/05/RxSwiftCheatSheet/';
          this.page.identifier = '2016/05/05/RxSwiftCheatSheet/';
          this.page.title = 'RxSwift 速查手册';
        };
        var d = document, s = d.createElement('script');
        s.src = 'https://futantan.disqus.com/embed.js';
        s.setAttribute('data-timestamp', '' + +new Date());
        (d.head || d.body).appendChild(s);
      </script>
    

  




	





  














  





  

  

  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


  

  

</body>
</html>
